    var Storage = {
            "Маргарита": {
                "name": "Маргарита",
                "price": 75,
                "currentPrice": 75,
                "composition": "Базилик, помидор, соус томатный, сыр моцарелла",
                "weight": "370гр",
                "diametr": "30см",
                "src": "img/pizza-cards/margarita.png",
                "count": "0"
            },
            "Прошутто кон фугги": {
                "name": "Прошутто кон фугги",
                "price": 89,
                "currentPrice": 89,
                "composition": "Ветчина, шампиньоны, петрушка, соус томатный, сыр моцарелла",
                "weight": "410гр",
                "diametr": "30см",
                "src": "img/pizza-cards/proshutto.png",
                "count": "0"
            },
            "Эмилия": {
                "name": "Эмилия",
                "price": 95,
                "currentPrice": 95,
                "composition": ["Базилик, салями, соус томатный, сыр моцарелла, сыр эдам"],
                "weight": "385гр",
                "diametr": "30см",
                "src": "img/pizza-cards/emiliya.png",
                "count": "0"
            },
            "Марджелина": {
                "name": "Марджелина",
                "price": 97,
                "currentPrice": 97,
                "composition": ["Шампиньоны, петрушка, помидор, соус томатный, сыр моцарелла, филе куриное копченое"],
                "weight": "430гр",
                "diametr": "30см",
                "src": "img/pizza-cards/mardjelina.png",
                "count": "0"
            },
            "Тропикале": {
                "name": "Тропикале",
                "price": 99,
                "currentPrice": 99,
                "composition": ["Ананас, ветчина, салями, соус томатный, сыр моцарелла"],
                "weight": "400гр",
                "diametr": "30см",
                "src": "img/pizza-cards/tropikale.png",
                "count": "0"
            },
            "Полло кон фрутта": {
                "name": "Полло кон фрутта",
                "price": 93,
                "currentPrice": 93,
                "composition": ["Кукуруза, ананас, ветчина, петрушка, соус томатный, сыр моцарелла, филе куриное копченое"],
                "weight": "435гр",
                "diametr": "30см",
                "src": "img/pizza-cards/pollo.png",
                "count": "0"
            },
            "Сицилиано": {
                "name": "Сицилиано",
                "price": 97,
                "currentPrice": 97,
                "composition": ["Базилик, ветчина, шампиньоны, салями, перец болгарский, соус томатный, сыр моцарелла"],
                "weight": "450гр",
                "diametr": "30см",
                "src": "img/pizza-cards/siciliano.png",
                "count": "0"
            },
            "Примавера": {
                "name": "Примавера",
                "price": 86,
                "currentPrice": 86,
                "composition": ["Базилик, шампиньоны, капуста брокколи, перец болгарский, помидор, соус томатный, спаржевая фасоль, сыр моцарелла, чеснок"],
                "weight": "470гр",
                "diametr": "30см",
                "src": "img/pizza-cards/primavera.png",
                "count": "0"
            },
            "Верона": {
                "name": "Верона",
                "price": 105,
                "currentPrice": 105,
                "composition": ["Сливки, ветчина, салями, петрушка, сыр моцарелла, сыр эдам, филе куриное копченое"],
                "weight": "415гр",
                "diametr": "30см",
                "src": "img/pizza-cards/verona.png",
                "count": "0"
            },
            "Барбекю": {
                "name": "Барбекю",
                "price": 103,
                "currentPrice": 103,
                "composition": ["Бекон", "колбаски охотничьи", "курица копченая", "петрушка", "соус томатный", "сыр моцарелла", "сыр копченый косичка"],
                "weight": "450гр",
                "diametr": "30см",
                "src": "img/pizza-cards/barbeku.png",
                "count": "0"
            },
            "Чиполло": {
                "name": "Чиполло",
                "price": 109,
                "currentPrice": 109,
                "composition": ["Бекон", "салями", "лук репчатый", "петрушка", "свинина", "соус томатный", "сыр моцарелла"],
                "weight": "430гр",
                "diametr": "30см",
                "src": "img/pizza-cards/chipollo.png",
                "count": "0"
            },
            "Баварезе": {
                "name": "Баварезе",
                "price": 105,
                "currentPrice": 105,
                "composition": ["Горчица, базилик, шампиньоны, колбаски охотничьи, колбаски пеперони, колбаски свинные, перец маринованый, соус томатный, сыр моцарелла"],
                "weight": "450гр",
                "diametr": "30см",
                "src": "img/pizza-cards/bavareze.png",
                "count": "0"
            },
            "Цезар": {
                "name": "Цезар",
                "price": 98,
                "currentPrice": 98,
                "composition": ["Горчица, сливки, салат айсберг, бекон, курица копченая, помидор, сыр пармезан, сыр моцарелла"],
                "weight": "445гр",
                "diametr": "30см",
                "src": "img/pizza-cards/cezar.png",
                "count": "0"
            },
            "Импреза": {
                "name": "Импреза",
                "price": 101,
                "currentPrice": 101,
                "composition": ["Базилик, бекон, шампиньоны, салями, колбаски пеперони, колбаски свинные, перец болгарский, соус томатный, сыр моцарелла"],
                "weight": "465гр",
                "diametr": "30см",
                "src": "img/pizza-cards/impreza.png",
                "count": "0"
            },
            "Изола": {
                "name": "Изола",
                "price": 109,
                "currentPrice": 109,
                "composition": ["Сливки, ананас, ветчина, сыр дорблю, сыр моцарелла, филе куриное копченое"],
                "weight": "400гр",
                "diametr": "30см",
                "src": "img/pizza-cards/izola.png",
                "count": "0"
            },
            "Адриано": {
                "name": "Адриано",
                "price": 112,
                "currentPrice": 112,
                "composition": ["Горчица в зернах, сливки, колбаски охотничьи, колбаски пеперони, сыр дорблю, сыр моцарелла"],
                "weight": "370гр",
                "diametr": "30см",
                "src": "img/pizza-cards/adriano.png",
                "count": "0"
            }
        };

    var basket = [];

    var content = [];

    var currentCost = 0;
    
    var standartCost;

    var state = false;

    var itemCount = 0;
        
    var allPrice;    
    
        $(window).scroll(function(){
            var height = $(this).scrollTop();
            if(height > 600)
            {
                $(".top-line").css("position", "fixed");
                $(".top-line").css("top", "0px");
            }
            if(height < 600)
            {
                $(".top-line").css("position", "absolute");
                $(".top-line").css("top", "600px");
            }
           
        });

        Array.prototype.removeConditional = function(comparator) {
            var result = [];
            this.forEach(function(arg) { if (!comparator(arg)) result.push(arg) });
            return result;
        };

        function Count(Storage) {
            
            var count = 0;
            for(var prs in Storage) 
            {    
                count++;
            }
            return count;
        }

        function Basket(arg) {
        
            this.id = Math.random();
            this.name = arg["name"];
            this.cost = arg["price"];
            this.currentCost = arg["currentPrice"];
            this.count = 1;
            this.src = arg["src"];
            allPrice += this.cost;            
  }

        function Add(id) {
            for (var i = 0; i < basket.length; i++) 
            {
              if (basket[i].id == id)
              {
                    basket[i].count++;
                    basket[i].currentCost += basket[i].cost;
                    allPrice += basket[i].cost;
                    itemCount++;
              }
            }
            Refresh();
          }

        function Remove(id) {
            for (var i = 0; i < basket.length; i++) {
              if (basket[i].id == id && basket[i].count>0)
              {
                basket[i].count--;
                basket[i].currentCost -= basket[i].cost;
                allPrice -= basket[i].cost;
                itemCount--;
                if(basket[i].count == 0)
                {
                    basket = basket.removeConditional((arg)=>arg.id == id);
                    localStorage.removeItem("basket");
                }
              }   
            }
            Refresh();
        }

        function Delete(id) {
            var name = $('.del').data("pizza-name");
            for(var i = 0; i < basket.length; i++)
            {
                if(basket[i].id == id)
                {
                    allPrice -= basket[i].cost*basket[i].count;
                    itemCount -=basket[i].count;
                }
            }
            basket = basket.removeConditional((arg)=>arg.id == id);
            localStorage.removeItem("basket");
                Refresh();
      }

        function Refresh() { 
                var state2 = false;
                $("#basket-content").html("")
                var basket_content = document.getElementById("basket-content");
                var basket_pizzas = document.createElement("div");
                basket_pizzas.className = "basket-pizza";
                var empty = document.createElement("div");
                empty.className = "empty";
                
                var imgEmpty = document.createElement("img");
                imgEmpty.setAttribute("src", "img/basket/empty.svg");
                
                var pEmpty = document.createElement("p");
                pEmpty.innerHTML = "Вы ещё ничего не добавили в корзину";

                basket_content.appendChild(empty);
                empty.appendChild(imgEmpty);
                empty.appendChild(pEmpty);
                
                if(basket.length == 0)
                {
                    $(".empty").css("display","block");
                    $("#imgBasket").attr("src", "img/basket/basket.png");
                }
                
                basket.forEach(function (item) {
                
                if(basket.length != 0)
                {
                    $(".empty").css("display", "none");
                    $("#imgBasket").attr("src","img/basket/basket-full.png");
                }
                
                var basket_pizza = document.createElement("div");
                basket_pizza.className = "basket-pizzas-1";

                var pizza_name = document.createElement("p");
                pizza_name.id = "pizza-name";
                pizza_name.innerHTML = item.name;
                
                var del = document.createElement("div");
                del.className = "del";
                del.innerHTML += "<img data-pizza-name="+item.name+" id='del' src='img/icons/cross-mark1.png' onclick='Delete("+item.id+")'></img>";

                var imgPizza = document.createElement("img");
                imgPizza.setAttribute("src", item.src);

                var minusBlock = document.createElement("div");
                minusBlock.className = "minus";
                minusBlock.innerHTML += "<img id='minus' src='img/icons/minus.png' onclick='Remove("+item.id+")'></img>"

                var numberBlock = document.createElement("div");
                numberBlock.className = "number";

                var number = document.createElement("p");
                number.id = item.id;
                number.id = "number";
                number.innerHTML = item.count;

                var plusBlock = document.createElement("div");
                plusBlock.className = "plus";
                plusBlock.innerHTML += "<img id='plus' src='img/icons/plus32.png' onclick='Add("+item.id+")'></img>"

                var pizza_cost = document.createElement("div");
                pizza_cost.className = "pizza-cost";
                var cost = document.createElement("p");
                cost.innerHTML = item.cost*item.count + "грн";
                cost.id = item.id*item.id;
                

                var line = document.createElement("div");
                line.className = "line";
                var imgLine = document.createElement("img");
                imgLine.setAttribute("src", "img/basket/line.png");

                basket_pizzas.appendChild(basket_pizza);
                basket_pizzas.appendChild(line);
                basket_pizza.appendChild(pizza_name);
                basket_pizza.appendChild(del);
                basket_pizza.appendChild(imgPizza);
                basket_pizza.appendChild(minusBlock);
                basket_pizza.appendChild(numberBlock);
                numberBlock.appendChild(number);
                basket_pizza.appendChild(plusBlock);
                basket_pizza.appendChild(pizza_cost);
                pizza_cost.appendChild(cost);
                line.appendChild(imgLine);
            
                var all_cost = document.createElement("div");
                all_cost.className = "all-cost";

                var allCost = document.createElement("p");
                allCost.id = "all-cost";
                if(itemCount >= 3)
                {
                    allCost.innerHTML = " Всего: " + (allPrice - allPrice * 0.15) + "грн";
                }
                else
                {
                    allCost.innerHTML = " Всего: " + allPrice + "грн";
                }
                
                var purchase_form = document.createElement("a");
                purchase_form.className = "fancybox fanc-form";
                purchase_form.setAttribute("href", "#purchase-form");
                
                var purchase = document.createElement("div");
                purchase.className = "purchase";

                var Ppurchase = document.createElement("p");
                Ppurchase.id = "purchase";
                Ppurchase.innerHTML = "Заказать";
                
                if(state2 == false)
                {
                    state2 = true;
                    basket_content.appendChild(basket_pizzas);
                    basket_content.appendChild(all_cost);
                    all_cost.appendChild(allCost);
                    all_cost.appendChild(purchase_form);
                    purchase_form.appendChild(purchase);
                    purchase.appendChild(Ppurchase);
                }
                localStorage.setItem("basket", JSON.stringify(basket));
            });
        }

        function Pizza(arg) {
            this.img = arg["src"];
            this.name = arg["name"];
            this.description = arg["composition"];
            this.cost = arg["price"];
            this.weight = arg["weight"];
            this.diameter = arg["diametr"];

            var line = document.getElementById("line");
            
            var card = document.createElement("div");
            card.className = "card-1";
            
            var top_card = document.createElement("div");
            top_card.className = "top-card";
            
            var imgPizza = document.createElement("img");
            imgPizza.setAttribute("src", this.img);
            
            var pizza_name = document.createElement("p");
            pizza_name.className = "pizza-name-card";
            pizza_name.innerHTML = this.name;
            
            var price = document.createElement("p");
            price.className = "price-card";
            price.innerHTML = this.cost;
            
            var grn = document.createElement("p");
            grn.className = "grivnas-card";
            grn.innerHTML = "грн";
            
            var buy = document.createElement("div");
            buy.className = "buy-card";
            buy.setAttribute("data-pizza-name", arg.name);
            
            var order = document.createElement("p");
            order.id = "buy-card";
            order.innerHTML = "Заказать";
            
            var bottom_card = document.createElement("div");
            bottom_card.className = "bottom-card";
            
            var line_card = document.createElement("div");
            line_card.className = "line-card";
            
            var lineImg = document.createElement("img");
            lineImg.setAttribute("src", "img/basket/line.png");
            
            var info = document.createElement("div");
            info.className = "info-card";
            
            var ingredients = document.createElement("span");
            ingredients.innerHTML = "Состав";
            
            var compos = document.createElement("p");
            compos.innerHTML = this.description;
            
            var iconCard = document.createElement("div");
            iconCard.className = "icon-card";
            
            var diam = document.createElement("div");
            diam.className = "diam";
            
            var imgDiam = document.createElement("img");
            imgDiam.setAttribute("src", "img/icons/diam.png");
            
            var diametr = document.createElement("p");
            diametr.innerHTML = this.diameter;
            
            var weight = document.createElement("div");
            weight.className = "weight";
            
            var imgWeight = document.createElement("img");
            imgWeight.setAttribute("src", "img/icons/weight.png");
            
            var gram = document.createElement("p");
            gram.innerHTML = this.weight;

            line.appendChild(card);
            card.appendChild(top_card);
            top_card.appendChild(imgPizza);
            top_card.appendChild(pizza_name);
            top_card.appendChild(price);
            top_card.appendChild(grn);
            top_card.appendChild(buy);
            buy.appendChild(order);
            card.appendChild(bottom_card);
            bottom_card.appendChild(line_card);
            line_card.appendChild(lineImg);
            bottom_card.appendChild(info);
            info.appendChild(ingredients);
            info.appendChild(compos);
            bottom_card.appendChild(iconCard);
            iconCard.appendChild(diam);
            diam.appendChild(imgDiam);
            diam.appendChild(diametr);
            iconCard.appendChild(weight);
            weight.appendChild(imgWeight);
            weight.appendChild(gram);
        }
        function Money()
        {
            basket.forEach(function(item){
                allPrice += item.cost * item.count;
                itemCount += item.count;
            });
            // alert(itemCount);
            // if(itemCount > 2)
            // {
            // allPrice = allPrice - allPrice * 0.15;
            // }
        }
     window.onload = function() {
         allPrice = 0;
        //var phoneState = false;
        // $(".phone-number img").click(function() {
        //   var wid = $(window).width();
        //  if(wid < 700)
        //  {
        //      if(phoneState == false)
        //     {
        //         $(".phone-number p").css("display", "block");
        //         phoneState = true;
        //     }
        //     else if(phoneState == true) 
        //     {
        //          $(".phone-number p").css("display", "none")
        //         phoneState = false;
        //     }
        //  }
        // });
        
         Count(Storage);
         for(var prs in Storage)
         {
             content.push(new Pizza(Storage[prs]));
         }

        $('.buy-card').click(function(){
            var name = $(this).data("pizza-name");
            var exist = false;
            if(state == false)
            {
                $(".basket-content").css("display", "block");
                state = true;
            }
            basket.forEach(function(arg){
            if (arg.name == Storage[name].name) 
                exist = true;
          });
            if (!exist)
            {
                basket.push(new Basket(Storage[name])); 
                itemCount++;
                Refresh();
            }
        });
         $('.plus').click(function(id){
             for (var i = 0; i < basket.length; i++) {
              if (basket[i].id == id)
              {
                    basket[i].count++;
                    basket[i].currentCost += basket[i].cost;
              }
            }
            Refresh();
         });
         $('#imgBasket').click(function() {
            if(state == false)
            {
                $(".basket-content").css("display", "block");
                state = true;
            }
            else if(state == true) 
            {
                 $(".basket-content").css("display", "none")
                state = false;
            }
         });
             var tmp = localStorage.getItem("basket")
             if(tmp != null)
             {
                basket = JSON.parse(tmp);
                Money();
                Refresh();
             }
     };